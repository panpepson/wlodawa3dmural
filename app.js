document.addEventListener('DOMContentLoaded',()=>{const video=document.getElementById('video'),canvas=document.getElementById('canvas'),context=canvas.getContext('2d',{willReadFrequently:!0}),redHeart=document.getElementById('redHeart'),blueHeart=document.getElementById('blueHeart'),toggleCameraBtn=document.getElementById('toggleCameraBtn'),expandBtn=document.getElementById('expandBtn'),collapseBtn=document.getElementById('collapseBtn'),cameraBtn=document.getElementById('cameraBtn');let isExpanded=!1,kolor='normal',redIntensity=0,blueIntensity=0;function drawVideoToCanvas(){context.drawImage(video,0,0,canvas.width,canvas.height);const imageData=context.getImageData(0,0,canvas.width,canvas.height),data=imageData.data;for(let i=0;i<data.length;i+=4)'red'===kolor?(data[i]=Math.min(data[i]+redIntensity,255),data[i+1]=Math.max(data[i+1]-1,0),data[i+2]=Math.max(data[i+2]-1,0)):'blue'===kolor?(data[i]=Math.max(data[i]-5,0),data[i+1]=Math.max(data[i+1]-1,0),data[i+2]=Math.min(data[i+2]+blueIntensity,255)):'normal'===kolor&&context.putImageData(imageData,0,0),requestAnimationFrame(drawVideoToCanvas)}function initCameraStream(){navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:'environment'}}}).then(stream=>{video.srcObject=stream,video.play(),video.addEventListener('loadedmetadata',()=>{canvas.width=video.videoWidth,canvas.height=video.videoHeight,drawVideoToCanvas()})}).catch(error=>{console.error('Błąd dostępu do kamery:',error)})}redHeart.onclick=()=>{kolor='red',redIntensity+=10},blueHeart.onclick=()=>{kolor='blue',blueIntensity+=10},window.onload=()=>{initCameraStream()},cameraBtn.onclick=()=>{},expandBtn.onclick=()=>{isExpanded||(video.classList.add('expanded'),canvas.classList.add('canvas1'),isExpanded=!0,collapseBtn.style.display='flex',expandBtn.style.display='none',cameraBtn.style.display='flex',redHeart.style.display='flex',blueHeart.style.display='flex')},collapseBtn.onclick=()=>{isExpanded&&(video.classList.remove('expanded'),canvas.classList.remove('canvas1'),isExpanded=!1,collapseBtn.style.display='none',expandBtn.style.display='flex',cameraBtn.style.display='none',redHeart.style.display='none',blueHeart.style.display='none',kolor='normal')}});
