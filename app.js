document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("video"),t=document.getElementById("canvas"),n=t.getContext("2d",{willReadFrequently:!0}),a=document.getElementById("redHeart"),o=document.getElementById("blueHeart"),d=document.getElementById("expandBtn"),i=document.getElementById("collapseBtn"),r=document.getElementById("cameraBtn");let c=!1,l="normal",m=0,u=0;function s(){n.drawImage(e,0,0,t.width,t.height);const a=n.getImageData(0,0,t.width,t.height),o=a.data;for(let e=0;e<o.length;e+=4)"red"===l?(o[e]=Math.min(o[e]+m,255),o[e+1]=Math.max(o[e+1]-1,0),o[e+2]=Math.max(o[e+2]-1,0)):"blue"===l&&(o[e]=Math.max(o[e]-5,0),o[e+1]=Math.max(o[e+1]-1,0),o[e+2]=Math.min(o[e+2]+u,255));n.putImageData(a,0,0),requestAnimationFrame(s)}function p(){navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}}).then(n=>{e.srcObject=n,e.play(),e.addEventListener("loadedmetadata",()=>{t.width=e.videoWidth,t.height=e.videoHeight,s()})}).catch(e=>{console.error("Błąd dostępu do kamery:",e)})}a.onclick=()=>{l="red",m+=10},o.onclick=()=>{l="blue",u+=10},window.onload=()=>{p()},r.onclick=()=>{},d.onclick=()=>{c||(e.classList.add("expanded"),t.classList.add("canvas1"),c=!0,i.style.display="flex",d.style.display="none",r.style.display="flex",a.style.display="flex",o.style.display="flex")},i.onclick=()=>{c&&(e.classList.remove("expanded"),t.classList.remove("canvas1"),c=!1,i.style.display="none",d.style.display="flex",r.style.display="none",a.style.display="none",o.style.display="none",l="normal")}});
